module.exports = {
  friendlyName: "Jwt Decryption",

  description: "Will Decrypt the private data of the User",

  extendedDescription: "It is used to get  Users private data",

  inputs: {
    token: {
      friendlyName: "Token string value",
      description: "This is Token generated by system to verify",
      type: "string",
    },
  },

  exits: {
    success: {
      friendlyName: "Decrypted user details",
      description: "Decrypted to get the user id",
    },
  },

  fn: async function (inputs, exits) {
    var jwtEncrypt = require("jwt-token-encrypt");
    try {
      const decrypted = jwtEncrypt.readJWT(
        inputs.token,
        sails.config.custom.jwtEncryption
      );
      return exits.success(decrypted);
    } catch (error) {
      // to catch all invalid token error
      return exits.success(null);
    }
  },
};
