module.exports = {
  friendlyName: "Jwt Decryption",

  description: "Will Decrypt the private data of the User",

  extendedDescription: "It is used to get  Users private data",

  inputs: {
    token: {
      friendlyName: "Token string value",
      description: "This is Token generated by system to verify",
      type: "string",
    },
  },

  exits: {
    success: {
      friendlyName: "Decrypted device details",
      description: "Decrypted to get the device id",
    },
  },

  fn: async function (inputs, exits) {
    var jwt = require("jsonwebtoken");
    try {

      var decrypted = jwt.verify(inputs.token, sails.config.custom.privateKey);

      return exits.success(decrypted);
    } catch (error) {
      // to catch all invalid token error
      return exits.success(null);
    }
  },
};
