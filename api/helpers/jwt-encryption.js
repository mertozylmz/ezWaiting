// api/helpers/jwt-encryption.js

module.exports = {
  friendlyName: "Jwt Encryption",

  description: "Will Encrypt the private data of the device",

  inputs: {
    deviceId: {
      type: "string",
      description: "Unique device Id.",
    },
  },
  exits: {
    success: {
      friendlyName: "Token string value",
      description: "This is Token generated by system to verify",
    },
  },

  fn: async function (inputs, exits) {
    const jwt = require("jsonwebtoken");

    var etoken = await jwt.sign(
      {
        deviceId: inputs.deviceId,
      },
      sails.config.custom.privateKey,
      sails.config.custom.jwtEncryptionOptions
    );

    return exits.success({ token: etoken});
  },
};
